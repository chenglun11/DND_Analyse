# 地牢质量评估指标总结

## 概述

本项目包含7个核心质量评估指标，用于全面评估地牢设计的质量。每个指标都采用科学的评分映射方法，确保评估结果的合理性和可解释性。

## 指标详情

### 1. Accessibility (可达性)
- **描述**: 评估房间间的连通性，衡量玩家在地牢中的移动自由度
- **评分方法**: 分段线性映射
- **理想区间**: 0.6 ~ 0.95 (满分)
- **参数设置**:
  - 0.6 ≤ avg_access ≤ 0.95: 满分1.0
  - avg_access < 0.6: 线性递增 (0.3 ~ 1.0)
  - avg_access > 0.95: 线性递减 (1.0 ~ 0.5)
- **复杂度因子**: min(1.0, 房间数/6.0)
- **优化建议**: 增加房间间的连接，减少孤立区域

### 2. Dead End Ratio (死胡同比例)
- **描述**: 评估地牢中死胡同房间的比例，越低越好
- **评分方法**: 线性递减映射
- **计算公式**: max(0.2, 1.0 - dead_end_ratio × 0.8)
- **参数说明**:
  - dead_end_ratio = 死胡同房间数 / 总房间数
  - 死胡同定义: 度为1的房间（只有一个连接）
- **优化建议**: 减少死胡同房间，增加房间连接数

### 3. Loop Ratio (回环率)
- **描述**: 评估地牢中回路结构的比例，适中最好
- **评分方法**: 高斯型映射
- **参数设置**:
  - 中心值(μ): 0.3
  - 标准差(σ): 0.3
  - 计算公式: exp(-((loop_ratio-0.3)²)/(2×0.3²))
- **理想范围**: 0.2 ~ 0.4
- **优化建议**: 保持适度的回路结构，避免过多或过少的回环

### 4. Degree Variance (度方差)
- **描述**: 评估房间连接数的方差，适中最好
- **评分方法**: 高斯型映射 + 复杂度因子
- **参数设置**:
  - 中心值(μ): 2.0
  - 标准差(σ): 1.5
  - 复杂度因子: min(1.0, 房间数/6.0)
- **理想范围**: 1.0 ~ 3.0
- **优化建议**: 平衡房间连接数，避免连接数过于集中或分散

### 5. Path Diversity (路径多样性)
- **描述**: 评估房间对之间可选路径的数量，适中最好
- **评分方法**: 高斯型映射
- **参数设置**:
  - 中心值(μ): 2.0
  - 标准差(σ): 1.0
  - 计算公式: exp(-((avg_path_diversity-2.0)²)/(2×1.0²))
- **算法说明**: 计算所有房间对之间的最短路径数量
- **特殊情况**: 无可达路径时返回基础分数0.3
- **优化建议**: 增加可选路径，提高地牢的探索性

### 6. Door Distribution (门分布)
- **描述**: 评估门在地牢中的分布均匀性
- **评分方法**: 线性映射
- **计算公式**: 1.0 - door_distribution_variance
- **优化建议**: 均匀分布门，避免过于集中或分散

### 7. Key Path Length (关键路径长度)
- **描述**: 评估地牢中关键路径的长度合理性
- **评分方法**: 分段线性映射
- **参数设置**:
  - 理想长度: 5 ~ 15
  - 可接受长度: 3 ~ 20
- **优化建议**: 保持关键路径长度在合理范围内
### 8. Treasure & Monster Distribution (宝藏怪物分布)
- **描述**: 评估地牢中宝藏、怪物、Boss等游戏元素的分布质量
- **评分方法**: 多维度评估 + 扣分制
- **理论基础**: 游戏经济学理论、玩家心理学
- **评估维度**:
  - **密度评估**: 宝藏密度和怪物密度应在合理范围内
  - **Boss分布**: 应有Boss但不宜过多
  - **空间分布**: 元素应适度分散，避免过度集中
  - **距离关系**: 宝藏与怪物应保持适当距离
- **参数设置**:
  - 宝藏密度理想范围: 0.1 ~ 0.6
  - 怪物密度理想范围: 0.1 ~ 0.6
  - 空间分布阈值: spread ≥ 2.0
  - 距离阈值: treasure-monster ≥ 3.0, treasure-treasure ≥ 2.0, monster-monster ≥ 2.0
- **计算公式**:
  - 密度计算: $\text{density} = \frac{\text{元素数量}}{\text{房间数量}}$
  - 空间分布: $\text{spread} = \sqrt{\sigma_x^2 + \sigma_y^2}$
  - 平均距离: $\text{avg\_distance} = \frac{1}{N} \sum_{i,j} \sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}$
- **评分规则**:
  - 初始分数: 1.0
  - 密度超出范围: -0.2 (每项)
  - 无Boss: -0.15, Boss过多: -0.1
  - 空间分布过差: -0.15 (每项)
  - 距离过近: -0.1 (每项)
  - 有特殊元素: +0.05
- **优化建议**: 平衡游戏元素密度，合理分布Boss，保持元素间适当距离

### 9. Aesthetic Balance (美学平衡)
- **描述**: 基于格式塔心理学和视觉设计理论评估地牢的美学质量
- **评分方法**: 多维度理论评估 + 权重分配
- **理论基础**: 
  - 格式塔原则 (Wertheimer, 1923)
  - 视觉层次理论 (Arnheim, 1954)
  - 空间认知理论 (Lynch, 1960)
  - 游戏设计美学 (Schell, 2008)
- **评估维度**:
  - **格式塔原则 (30%)**: 邻近性、相似性、连续性
  - **视觉层次 (25%)**: 视觉重量平衡、焦点质量
  - **空间认知 (25%)**: 空间可读性、空间组织
  - **统一性与多样性 (20%)**: 设计协调性、变化适度性
- **参数设置**:
  - 邻近性: 平均距离2.0~5.0为最佳
  - 相似性: 变异系数0.1~0.3为最佳
  - 连续性: 角度间隙标准差<0.5为最佳
  - 视觉平衡: 左右/上下重量比>0.7为佳
- **计算公式**:
  - 房间面积方差: $\sigma^2 = \frac{1}{n} \sum_{i=1}^n (A_i - \bar{A})^2$
  - 变异系数: $\text{CV} = \frac{\sigma}{\mu}$
  - 视觉重量平衡: $\text{balance} = \frac{\min(W_L, W_R)}{\max(W_L, W_R)}$
  - 邻近性分数: 基于平均距离的分段函数
  - 相似性分数: 基于变异系数的分段函数
- **评分规则**:
  - 初始分数: 1.0
  - 格式塔原则: 均分<0.4扣0.3, <0.7扣0.15
  - 视觉层次: 均分<0.4扣0.25, <0.7扣0.1
  - 空间认知: 均分<0.4扣0.25, <0.7扣0.1
  - 统一性与多样性: 均分<0.4扣0.2, <0.7扣0.1
  - 格式塔与视觉层次均>0.8: +0.1
- **优化建议**: 保持房间大小适度变化，确保空间分布平衡，创建清晰的视觉层次