# Dungeon Adapter é¡¹ç›®å®Œæ•´æ–¹æ³•è®º

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

Dungeon Adapter æ˜¯ä¸€ä¸ªåŸºäºç§‘å­¦ç†è®ºçš„åœ°ç‰¢è®¾è®¡è´¨é‡è¯„ä¼°å’Œæ ¼å¼é€‚é…ç³»ç»Ÿã€‚é¡¹ç›®å°†åœ°ç‰¢è®¾è®¡ä»è‰ºæœ¯åˆ›ä½œè½¬åŒ–ä¸ºå¯é‡åŒ–ã€å¯è¯„ä¼°ã€å¯æ”¹è¿›çš„å·¥ç¨‹è¿‡ç¨‹ï¼Œé€šè¿‡å¤šç»´åº¦è¯„ä¼°ä½“ç³»ä¸ºåœ°ç‰¢è®¾è®¡æä¾›ç§‘å­¦æŒ‡å¯¼ã€‚

### æ ¸å¿ƒç›®æ ‡
- **æ ‡å‡†åŒ–**: å»ºç«‹ç»Ÿä¸€çš„åœ°ç‰¢æ•°æ®æ ¼å¼æ ‡å‡†
- **é‡åŒ–è¯„ä¼°**: åŸºäºç†è®ºçš„å¤šç»´åº¦è´¨é‡è¯„ä¼°ä½“ç³»
- **æŒç»­æ”¹è¿›**: æ•°æ®é©±åŠ¨çš„è®¾è®¡ä¼˜åŒ–æ–¹æ³•è®º
- **ç§‘å­¦æŒ‡å¯¼**: åŸºäºå­¦æœ¯ç†è®ºçš„è®¾è®¡åŸåˆ™

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ–¹æ³•è®º

### 1. æ’ä»¶å¼æ¶æ„è®¾è®¡

#### è®¾è®¡åŸåˆ™
- **æ¨¡å—åŒ–**: åŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **æ ‡å‡†åŒ–**: ç»Ÿä¸€æ¥å£ï¼Œç¡®ä¿ç³»ç»Ÿä¸€è‡´æ€§
- **åŠ¨æ€æ€§**: è‡ªåŠ¨å‘ç°å’ŒåŠ è½½æ’ä»¶
- **æ¾è€¦åˆ**: æœ€å°ä¾èµ–ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§

#### æ¶æ„å±‚æ¬¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            CLI æ¥å£å±‚                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           ä¸šåŠ¡é€»è¾‘å±‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ é€‚é…å™¨ç®¡ç†å™¨ â”‚ â”‚ è´¨é‡è¯„ä¼°å™¨  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           é€‚é…å™¨æ’ä»¶å±‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Watabou     â”‚ â”‚ DungeonDraftâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ OnePage     â”‚ â”‚ FiMapElites â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           æ ¸å¿ƒæœåŠ¡å±‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ç©ºé—´æ¨æ–­å¼•æ“ â”‚ â”‚ å¯è§†åŒ–å¼•æ“  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é€‚é…å™¨å¼€å‘è§„èŒƒ
```python
class BaseAdapter(ABC):
    @property
    @abstractmethod
    def format_name(self) -> str:
        """è¿”å›æ ¼å¼åç§°"""
        pass

    @abstractmethod
    def detect(self, data: Dict[str, Any]) -> bool:
        """æ ¼å¼æ£€æµ‹"""
        pass

    @abstractmethod
    def convert(self, data: Dict[str, Any]) -> Optional[UnifiedDungeonFormat]:
        """æ ¼å¼è½¬æ¢"""
        pass
```

### 2. ç»Ÿä¸€æ•°æ®æ ¼å¼æ ‡å‡†

#### æ ¼å¼è§„èŒƒ (v1.0.0)
```json
{
  "header": {
    "schemaName": "dnd-dungeon-unified",
    "schemaVersion": "1.0.0",
    "name": "åœ°ç‰¢åç§°",
    "author": "ä½œè€…",
    "description": "æè¿°",
    "grid": {"type": "square", "size": 5, "unit": "ft"}
  },
  "levels": [
    {
      "id": "level_1",
      "name": "å±‚çº§åç§°",
      "map": {"width": 50, "height": 50},
      "rooms": [...],
      "doors": [...],
      "corridors": [...],
      "connections": [...],
      "game_elements": [...]
    }
  ]
}
```

#### è®¾è®¡åŸåˆ™
- **å‘åå…¼å®¹**: ç‰ˆæœ¬å‡çº§ä¿æŒå…¼å®¹æ€§
- **æ‰©å±•æ€§**: æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•
- **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„æ•°æ®ç»“æ„å®šä¹‰
- **å®Œæ•´æ€§**: åŒ…å«æ‰€æœ‰å¿…è¦çš„åœ°ç‰¢å…ƒç´ 

## ğŸ“Š ç§‘å­¦è´¨é‡è¯„ä¼°æ–¹æ³•è®º

### 1. ä¸‰ç»´è¯„ä¼°ä½“ç³»

åŸºäºæ¸¸æˆè®¾è®¡ç†è®ºã€ç©ºé—´è®¤çŸ¥ç§‘å­¦å’Œè§†è§‰æ„ŸçŸ¥ç†è®ºï¼Œå»ºç«‹ä¸‰ç»´è¯„ä¼°ä½“ç³»ï¼š

#### ç»“æ„ç±» (Structural) - 40%æƒé‡
**ç†è®ºåŸºç¡€**: å›¾è®ºã€ç©ºé—´æ‹“æ‰‘å­¦ã€ç½‘ç»œåˆ†æ

| æŒ‡æ ‡åç§° | æƒé‡ | è¯„ä¼°ç»´åº¦ | ç†è®ºåŸºç¡€ | è¯„åˆ†æ–¹æ³• | ç†æƒ³èŒƒå›´ |
|---------|------|----------|----------|----------|----------|
| **å¯è¾¾æ€§** | 15% | è¿é€šæ€§ | å›¾è®ºè¿é€šæ€§ | åˆ†æ®µçº¿æ€§æ˜ å°„ | 0.6-0.95 |
| **åº¦æ–¹å·®** | 10% | è¿æ¥å¹³è¡¡ | ç½‘ç»œåˆ†æ | é«˜æ–¯æ˜ å°„ | 1.0-3.0 |
| **é—¨åˆ†å¸ƒ** | 10% | å…¥å£åˆç†æ€§ | ç©ºé—´æ‹“æ‰‘ | å¤šç»´åº¦è¯„ä¼° | 1.5-3.0é—¨/æˆ¿é—´ |
| **ç¯è·¯æ¯”ä¾‹** | 5% | å¤æ‚åº¦ | å›¾è®ºç¯è·¯ | é«˜æ–¯æ˜ å°„ | 0.2-0.4 |

#### æ¸¸æˆæ€§ç±» (Gameplay) - 40%æƒé‡
**ç†è®ºåŸºç¡€**: æ¸¸æˆè®¾è®¡ç†è®ºã€ç©å®¶å¿ƒç†å­¦ã€æ¸¸æˆç»æµå­¦

| æŒ‡æ ‡åç§° | æƒé‡ | è¯„ä¼°ç»´åº¦ | ç†è®ºåŸºç¡€ | è¯„åˆ†æ–¹æ³• | ç†æƒ³èŒƒå›´ |
|---------|------|----------|----------|----------|----------|
| **è·¯å¾„å¤šæ ·æ€§** | 15% | æ¢ç´¢æ€§ | é€‰æ‹©ç†è®º | é«˜æ–¯æ˜ å°„ | 2.0Â±1.0 |
| **å®è—æ€ªç‰©åˆ†å¸ƒ** | 20% | æ¸¸æˆå¹³è¡¡ | æ¸¸æˆç»æµå­¦ | å¤šç»´åº¦è¯„ä¼° | å¯†åº¦0.1-0.6 |
| **æ­»èƒ¡åŒæ¯”ä¾‹** | 5% | æ¢ç´¢ä½“éªŒ | ç©å®¶å¿ƒç†å­¦ | çº¿æ€§é€’å‡ | <0.3 |

#### ç¾æœ¯ç±» (Aesthetic) - 20%æƒé‡
**ç†è®ºåŸºç¡€**: æ ¼å¼å¡”å¿ƒç†å­¦ã€è§†è§‰è®¾è®¡ç†è®ºã€ç©ºé—´è®¤çŸ¥

| æŒ‡æ ‡åç§° | æƒé‡ | è¯„ä¼°ç»´åº¦ | ç†è®ºåŸºç¡€ | è¯„åˆ†æ–¹æ³• | ç†æƒ³èŒƒå›´ |
|---------|------|----------|----------|----------|----------|
| **è§†è§‰å¹³è¡¡** | 20% | ç¾å­¦è´¨é‡ | æ ¼å¼å¡”åŸåˆ™ | å¤šç»´åº¦è¯„ä¼° | >0.7 |

### 2. è¯¦ç»†è¯„ä¼°æŒ‡æ ‡ç†è®ºä¾æ®

#### 2.1 å¯è¾¾æ€§ (Accessibility)
**ç†è®ºåŸºç¡€**: å›¾è®ºè¿é€šæ€§åˆ†æ
- **æ ¸å¿ƒæ¦‚å¿µ**: ä»ä»»æ„æˆ¿é—´åˆ°è¾¾å…¶ä»–æˆ¿é—´çš„éš¾æ˜“ç¨‹åº¦
- **è®¡ç®—æ–¹æ³•**: BFSéå†ï¼Œè®¡ç®—å¯è¾¾æˆ¿é—´æ¯”ä¾‹
- **ç†æƒ³èŒƒå›´**: 0.6-0.95 (å¹³è¡¡æ¢ç´¢ä¸æŒ‘æˆ˜)
- **æ–‡çŒ®æ”¯æŒ**: 
  - Newman, M. E. J. (2010). Networks: An introduction
  - BarabÃ¡si, A. L. (2016). Network science

#### 2.2 é—¨åˆ†å¸ƒ (Door Distribution)
**ç†è®ºåŸºç¡€**: ç©ºé—´æ‹“æ‰‘å­¦ã€å»ºç­‘ç©ºé—´ç†è®º
- **æ ¸å¿ƒæ¦‚å¿µ**: é—¨åœ¨åœ°ç‰¢ä¸­çš„æ•°é‡å’Œåˆ†å¸ƒåˆç†æ€§
- **è¯„ä¼°ç»´åº¦**:
  - é—¨æ•°é‡åˆç†æ€§ (40%): æ¯ä¸ªæˆ¿é—´1.5-3ä¸ªé—¨
  - åˆ†å¸ƒå‡åŒ€æ€§ (40%): æ ‡å‡†åŒ–æ–¹å·®è¯„ä¼°
  - è¿é€šæ€§ä¿è¯ (20%): é˜²æ­¢å­¤ç«‹æˆ¿é—´
- **æ–‡çŒ®æ”¯æŒ**:
  - Lynch, K. (1960). The image of the city
  - Kaplan, S., & Kaplan, R. (1982). Cognition and environment
  - Schell, J. (2008). The art of game design

#### 2.3 è·¯å¾„å¤šæ ·æ€§ (Path Diversity)
**ç†è®ºåŸºç¡€**: é€‰æ‹©ç†è®ºã€æ¢ç´¢å¿ƒç†å­¦
- **æ ¸å¿ƒæ¦‚å¿µ**: æˆ¿é—´å¯¹ä¹‹é—´å¯é€‰è·¯å¾„çš„æ•°é‡
- **è®¡ç®—æ–¹æ³•**: æœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œç»Ÿè®¡è·¯å¾„æ•°é‡
- **ç†æƒ³èŒƒå›´**: 2.0Â±1.0 (é€‚åº¦é€‰æ‹©ï¼Œé¿å…è¿‡åº¦å¤æ‚)
- **æ–‡çŒ®æ”¯æŒ**:
  - Schwartz, B. (2004). The paradox of choice
  - Norman, D. A. (2013). The design of everyday things

#### 2.4 å®è—æ€ªç‰©åˆ†å¸ƒ (Treasure-Monster Distribution)
**ç†è®ºåŸºç¡€**: æ¸¸æˆç»æµå­¦ã€å¹³è¡¡è®¾è®¡ç†è®º
- **è¯„ä¼°ç»´åº¦**:
  - å¯†åº¦å¹³è¡¡: å®è—å’Œæ€ªç‰©å¯†åº¦åœ¨0.1-0.6ä¹‹é—´
  - ç©ºé—´åˆ†å¸ƒ: é¿å…è¿‡åº¦èšé›†
  - è·ç¦»å…³ç³»: å®è—ä¸æ€ªç‰©ä¿æŒé€‚å½“è·ç¦»
- **æ–‡çŒ®æ”¯æŒ**:
  - Koster, R. (2013). Theory of fun for game design
  - Fullerton, T. (2014). Game design workshop

#### 2.5 è§†è§‰å¹³è¡¡ (Aesthetic Balance)
**ç†è®ºåŸºç¡€**: æ ¼å¼å¡”å¿ƒç†å­¦ã€è§†è§‰è®¾è®¡ç†è®º
- **è¯„ä¼°ç»´åº¦**:
  - æ ¼å¼å¡”åŸåˆ™ (30%): é‚»è¿‘æ€§ã€ç›¸ä¼¼æ€§ã€è¿ç»­æ€§
  - è§†è§‰å±‚æ¬¡ (25%): è§†è§‰é‡é‡å¹³è¡¡ã€ç„¦ç‚¹è´¨é‡
  - ç©ºé—´è®¤çŸ¥ (25%): ç©ºé—´å¯è¯»æ€§ã€ç©ºé—´ç»„ç»‡
  - ç»Ÿä¸€ä¸å¤šæ · (20%): è®¾è®¡ä¸€è‡´æ€§ã€è¶£å‘³æ€§
- **æ–‡çŒ®æ”¯æŒ**:
  - Wertheimer, M. (1923). Laws of organization in perceptual forms
  - Arnheim, R. (1954). Art and visual perception
  - Norman, D. A. (2004). Emotional design

### 3. ç®—æ³•å®ç°åŸç†

#### 3.1 å¯è¾¾æ€§è¯„ä¼°ç®—æ³•
```python
def evaluate_accessibility(dungeon_data):
    """
    åŸºäºå›¾è®ºçš„å¯è¾¾æ€§è¯„ä¼°
    ç†è®ºåŸºç¡€: ç½‘ç»œè¿é€šæ€§åˆ†æ
    """
    # 1. æ„å»ºé‚»æ¥å›¾
    graph = build_adjacency_graph(dungeon_data)
    
    # 2. è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å¯è¾¾æ€§
    accessibility_scores = []
    for node in all_nodes:
        reachable_nodes = bfs_traversal(graph, node)
        accessibility = len(reachable_nodes) / len(all_nodes)
        accessibility_scores.append(accessibility)
    
    # 3. åˆ†æ®µçº¿æ€§æ˜ å°„è¯„åˆ†
    avg_accessibility = np.mean(accessibility_scores)
    if 0.6 <= avg_accessibility <= 0.95:
        score = 1.0  # ç†æƒ³èŒƒå›´
    elif avg_accessibility < 0.6:
        score = 0.3 + 0.7 * (avg_accessibility / 0.6)  # çº¿æ€§æƒ©ç½š
    else:
        score = max(0.5, 1.0 - (avg_accessibility - 0.95) / 0.1)  # è¿‡åº¦è¿æ¥æƒ©ç½š
    
    return score * complexity_factor
```

#### 3.2 é—¨åˆ†å¸ƒè¯„ä¼°ç®—æ³•
```python
def evaluate_door_distribution(dungeon_data):
    """
    åŸºäºç©ºé—´æ‹“æ‰‘å­¦çš„é—¨åˆ†å¸ƒè¯„ä¼°
    ç†è®ºåŸºç¡€: å»ºç­‘ç©ºé—´ç†è®ºã€æ¸¸æˆè®¾è®¡åŸåˆ™
    """
    # 1. ç»Ÿè®¡é—¨æ•°é‡åˆ†å¸ƒ
    room_door_counts = count_doors_per_room(dungeon_data)
    mean_doors = np.mean(room_door_counts)
    door_variance = np.var(room_door_counts)
    
    # 2. é—¨æ•°é‡åˆç†æ€§è¯„ä¼° (40%)
    if mean_doors < 1.0:
        door_quantity_score = mean_doors / 1.0  # è¿é€šæ€§ä¸è¶³
    elif 1.0 <= mean_doors <= 3.0:
        door_quantity_score = 1.0  # ç†æƒ³èŒƒå›´
    else:
        door_quantity_score = max(0.0, 1.0 - (mean_doors - 3.0) / 3.0)  # è¿‡åº¦å¤æ‚
    
    # 3. åˆ†å¸ƒå‡åŒ€æ€§è¯„ä¼° (40%)
    normalized_variance = door_variance / (mean_doors ** 2) if mean_doors > 0 else 0.0
    distribution_score = max(0.0, 1.0 - normalized_variance)
    
    # 4. è¿é€šæ€§ä¿è¯è¯„ä¼° (20%)
    isolated_rooms = sum(1 for count in room_door_counts if count == 0)
    connectivity_score = max(0.0, 1.0 - (isolated_rooms / len(room_door_counts)))
    
    # 5. ç»¼åˆè¯„åˆ†
    final_score = (door_quantity_score * 0.4 + 
                  distribution_score * 0.4 + 
                  connectivity_score * 0.2)
    
    return final_score
```

#### 3.3 è·¯å¾„å¤šæ ·æ€§è¯„ä¼°ç®—æ³•
```python
def evaluate_path_diversity(dungeon_data):
    """
    åŸºäºé€‰æ‹©ç†è®ºçš„è·¯å¾„å¤šæ ·æ€§è¯„ä¼°
    ç†è®ºåŸºç¡€: æ¢ç´¢å¿ƒç†å­¦ã€é€‰æ‹©ç†è®º
    """
    # 1. è®¡ç®—æ‰€æœ‰æˆ¿é—´å¯¹ä¹‹é—´çš„è·¯å¾„æ•°é‡
    path_counts = []
    for i, room_a in enumerate(rooms):
        for j, room_b in enumerate(rooms):
            if i >= j:
                continue
            paths = find_all_paths(graph, room_a, room_b)
            path_counts.append(len(paths))
    
    # 2. è®¡ç®—å¹³å‡è·¯å¾„å¤šæ ·æ€§
    avg_path_diversity = np.mean(path_counts) if path_counts else 0.0
    
    # 3. é«˜æ–¯æ˜ å°„è¯„åˆ†
    # ç†æƒ³å€¼: 2.0, æ ‡å‡†å·®: 1.0
    score = np.exp(-((avg_path_diversity - 2.0) ** 2) / (2 * 1.0 ** 2))
    
    # 4. ç‰¹æ®Šæƒ…å†µå¤„ç†
    if avg_path_diversity == 0:
        score = 0.3  # åŸºç¡€åˆ†æ•°
    
    return score
```

### 4. ç©ºé—´æ¨æ–­æŠ€æœ¯

#### 4.1 é‚»æ¥æ¨æ–­ç®—æ³•
```python
def infer_connections(rooms, threshold=1.0):
    """
    åŸºäºç©ºé—´é‚»æ¥çš„è¿æ¥æ¨æ–­
    ç†è®ºåŸºç¡€: ç©ºé—´è®¤çŸ¥ç†è®ºã€å»ºç­‘ç©ºé—´å…³ç³»
    """
    connections = []
    for i, room_a in enumerate(rooms):
        for j, room_b in enumerate(rooms):
            if i >= j:
                continue
            
            # è®¡ç®—æˆ¿é—´è¾¹ç•Œ
            ax1, ay1, ax2, ay2 = get_room_bounds(room_a)
            bx1, by1, bx2, by2 = get_room_bounds(room_b)
            
            # åˆ¤æ–­é‚»æ¥å…³ç³»
            if are_rooms_adjacent(ax1, ay1, ax2, ay2, bx1, by1, bx2, by2, threshold):
                connection = {
                    'from_room': room_a['id'],
                    'to_room': room_b['id'],
                    'inferred': True,
                    'confidence': calculate_adjacency_confidence(room_a, room_b)
                }
                connections.append(connection)
    
    return connections
```

#### 4.2 é—¨ä½ç½®æ¨æ–­
```python
def infer_door_position(room_a, room_b):
    """
    åŸºäºç©ºé—´å…³ç³»çš„é—¨ä½ç½®æ¨æ–­
    ç†è®ºåŸºç¡€: å»ºç­‘ç©ºé—´è®¾è®¡åŸåˆ™
    """
    # è®¡ç®—é‡å åŒºåŸŸ
    overlap_x1 = max(room_a.x1, room_b.x1)
    overlap_x2 = min(room_a.x2, room_b.x2)
    overlap_y1 = max(room_a.y1, room_b.y1)
    overlap_y2 = min(room_a.y2, room_b.y2)
    
    # æ ¹æ®é‚»æ¥æ–¹å‘ç¡®å®šé—¨ä½ç½®
    if horizontal_adjacent:
        x = overlap_x1 if abs(room_a.x2 - room_b.x1) <= threshold else overlap_x2
        y = (overlap_y1 + overlap_y2) / 2
    else:
        y = overlap_y1 if abs(room_a.y2 - room_b.y1) <= threshold else overlap_y2
        x = (overlap_x1 + overlap_x2) / 2
    
    return {'x': x, 'y': y}
```

## ğŸ”¬ åŸºå‡†æµ‹è¯•æ–¹æ³•è®º

### 1. æ ‡å‡†æµ‹è¯•é›†æ„å»º

#### æ•°æ®æ”¶é›†ç­–ç•¥
- **ç¨‹åºç”Ÿæˆåœ°ç‰¢**: Watabou (100ä¸ª), DungeonDraft (50ä¸ª), FiMapElites (50ä¸ª)
- **æ‰‹åŠ¨è®¾è®¡åœ°ç‰¢**: One Page Dungeon (30ä¸ª), ç»å…¸æ¨¡å— (20ä¸ª)
- **ç¤¾åŒºåˆ›ä½œ**: é«˜è´¨é‡ç¤¾åŒºä½œå“ (50ä¸ª)

#### åˆ†ç±»æ ‡å‡†
- **ç®€å•åœ°ç‰¢**: 5-10æˆ¿é—´ï¼Œé€‚åˆæ–°æ‰‹
- **ä¸­ç­‰å¤æ‚åº¦**: 10-20æˆ¿é—´ï¼Œå¹³è¡¡æ¢ç´¢ä¸æŒ‘æˆ˜
- **å¤æ‚åœ°ç‰¢**: 20-40æˆ¿é—´ï¼Œæ·±åº¦æ¢ç´¢ä½“éªŒ
- **æç«¯å¤æ‚**: 40+æˆ¿é—´ï¼Œé«˜çº§ç©å®¶æŒ‘æˆ˜

### 2. è´¨é‡åŸºå‡†å®šä¹‰

#### ä¼˜ç§€åŸºå‡† (Açº§: 0.8-1.0)
- ç»“æ„ç±» â‰¥ 0.8
- æ¸¸æˆæ€§ç±» â‰¥ 0.8
- ç¾æœ¯ç±» â‰¥ 0.7

#### è‰¯å¥½åŸºå‡† (Bçº§: 0.6-0.8)
- ç»“æ„ç±» â‰¥ 0.7
- æ¸¸æˆæ€§ç±» â‰¥ 0.7
- ç¾æœ¯ç±» â‰¥ 0.6

#### ä¸€èˆ¬åŸºå‡† (Cçº§: 0.4-0.6)
- ç»“æ„ç±» â‰¥ 0.5
- æ¸¸æˆæ€§ç±» â‰¥ 0.5
- ç¾æœ¯ç±» â‰¥ 0.4

#### è¾ƒå·®åŸºå‡† (Dçº§: 0.2-0.4)
- ä»»ä¸€ç±»åˆ« < 0.4

#### éœ€è¦é‡æ–°è®¾è®¡ (Fçº§: 0.0-0.2)
- ä»»ä¸€ç±»åˆ« < 0.2

### 3. å‚è€ƒåœ°ç‰¢åˆ†æ

#### ç»å…¸åœ°ç‰¢ç‰¹å¾
```json
{
  "tomb_of_horrors": {
    "è®¾è®¡å“²å­¦": "æŒ‘æˆ˜æ€§è®¾è®¡ï¼Œå¼ºè°ƒææ€–æ°›å›´",
    "ç›®æ ‡æŒ‡æ ‡": {
      "structural": 0.7,
      "gameplay": 0.8,
      "aesthetic": 0.6
    },
    "è®¾è®¡ç‰¹ç‚¹": {
      "é«˜æŒ‘æˆ˜æ€§": "å¤§é‡é™·é˜±å’Œæ­»èƒ¡åŒ",
      "ææ€–æ°›å›´": "è§†è§‰è®¾è®¡å¼ºè°ƒææƒ§æ„Ÿ",
      "æ¢ç´¢å¥–åŠ±": "é«˜é£é™©é«˜å›æŠ¥"
    }
  },
  "castle_ravenloft": {
    "è®¾è®¡å“²å­¦": "å“¥ç‰¹å¼ææ€–ï¼Œå¤šå±‚æ¬¡æ¢ç´¢",
    "ç›®æ ‡æŒ‡æ ‡": {
      "structural": 0.8,
      "gameplay": 0.9,
      "aesthetic": 0.8
    },
    "è®¾è®¡ç‰¹ç‚¹": {
      "å‚ç›´è®¾è®¡": "å¤šå±‚å»ºç­‘ç»“æ„",
      "ä¸»é¢˜ä¸€è‡´": "å“¥ç‰¹å¼å»ºç­‘ç¾å­¦",
      "æ¢ç´¢æ·±åº¦": "ä¸°å¯Œçš„éšè—åŒºåŸŸ"
    }
  }
}
```

## ğŸ¨ å¯è§†åŒ–æ–¹æ³•è®º

### 1. å¤šæ ¼å¼å¯è§†åŒ–æ”¯æŒ

#### SVGæ ¼å¼
- **çŸ¢é‡å›¾å½¢**: æ— æŸç¼©æ”¾ï¼Œé€‚åˆæ‰“å°
- **äº¤äº’å…ƒç´ **: æ”¯æŒç‚¹å‡»å’Œæ‚¬åœ
- **æ ·å¼å®šåˆ¶**: CSSæ ·å¼æ§åˆ¶

#### PNGæ ¼å¼
- **ä½å›¾æ ¼å¼**: é€‚åˆå±å¹•æ˜¾ç¤º
- **é«˜è´¨é‡**: æ”¯æŒé€æ˜èƒŒæ™¯
- **æ–‡ä»¶å¤§å°**: ä¼˜åŒ–çš„å‹ç¼©ç®—æ³•

### 2. è§†è§‰å…ƒç´ è®¾è®¡

#### æˆ¿é—´è¡¨ç¤º
- **å¤šè¾¹å½¢ç»˜åˆ¶**: æ”¯æŒä¸è§„åˆ™æˆ¿é—´å½¢çŠ¶
- **æ¸å˜å¡«å……**: æŸ”å’Œçš„è§†è§‰æ•ˆæœ
- **è¾¹æ¡†æ ·å¼**: æ¸…æ™°çš„è¾¹ç•Œå®šä¹‰

#### é—¨è¡¨ç¤º
- **ç‚¹æ ‡è®°**: ç®€æ´çš„é—¨ä½ç½®æ ‡è¯†
- **é¢œè‰²ç¼–ç **: ä¸åŒç±»å‹çš„é—¨ä½¿ç”¨ä¸åŒé¢œè‰²
- **å¤§å°å˜åŒ–**: æ ¹æ®é‡è¦æ€§è°ƒæ•´å¤§å°

#### æ¸¸æˆå…ƒç´ 
- **ç¬¦å·ç³»ç»Ÿ**: ç»Ÿä¸€çš„å…ƒç´ ç¬¦å·
- **é¢œè‰²åˆ†ç±»**: æŒ‰ç±»å‹ä½¿ç”¨ä¸åŒé¢œè‰²
- **å¤§å°å±‚æ¬¡**: æ ¹æ®é‡è¦æ€§è°ƒæ•´å¤§å°

### 3. ç¾å­¦è®¾è®¡åŸåˆ™

#### è‰²å½©ç†è®º
- **å’Œè°é…è‰²**: åŸºäºè‰²å½©è½®ç†è®º
- **å¯¹æ¯”åº¦**: ç¡®ä¿å¯è¯»æ€§
- **ä¸»é¢˜è‰²å½©**: ç¬¦åˆåœ°ç‰¢ä¸»é¢˜

#### å¸ƒå±€åŸåˆ™
- **è§†è§‰å±‚æ¬¡**: é‡è¦ä¿¡æ¯çªå‡ºæ˜¾ç¤º
- **ç©ºé—´å¹³è¡¡**: å…ƒç´ åˆ†å¸ƒå‡åŒ€
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„è§†è§‰é£æ ¼

## ğŸ“ˆ æŒç»­æ”¹è¿›æ–¹æ³•è®º

### 1. æ•°æ®é©±åŠ¨ä¼˜åŒ–

#### æ€§èƒ½ç›‘æ§
- **è½¬æ¢é€Ÿåº¦**: é€‚é…å™¨æ€§èƒ½æŒ‡æ ‡
- **å†…å­˜ä½¿ç”¨**: èµ„æºæ¶ˆè€—ç›‘æ§
- **é”™è¯¯ç‡**: è½¬æ¢æˆåŠŸç‡ç»Ÿè®¡

#### è´¨é‡è¿½è¸ª
- **è¯„åˆ†åˆ†å¸ƒ**: è´¨é‡åˆ†æ•°ç»Ÿè®¡
- **æ”¹è¿›è¶‹åŠ¿**: ç‰ˆæœ¬é—´è´¨é‡å˜åŒ–
- **ç”¨æˆ·åé¦ˆ**: å®é™…ä½¿ç”¨æ•ˆæœ

### 2. ç®—æ³•ä¼˜åŒ–

#### ç©ºé—´æ¨æ–­ä¼˜åŒ–
- **ç®—æ³•æ•ˆç‡**: æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–
- **å‡†ç¡®æ€§æå‡**: æ¨æ–­ç²¾åº¦æ”¹è¿›
- **å‚æ•°è°ƒä¼˜**: é˜ˆå€¼è‡ªåŠ¨è°ƒæ•´

#### è¯„åˆ†ç®—æ³•ä¼˜åŒ–
- **æƒé‡è°ƒæ•´**: åŸºäºå®é™…æ•ˆæœè°ƒæ•´
- **é˜ˆå€¼ä¼˜åŒ–**: æ ¹æ®åŸºå‡†æ•°æ®è°ƒæ•´
- **æ–°æŒ‡æ ‡**: å¼•å…¥æ–°çš„è¯„ä¼°ç»´åº¦

### 3. ç”¨æˆ·åé¦ˆé›†æˆ

#### åé¦ˆæ”¶é›†
- **ç”¨æˆ·è¯„åˆ†**: ä¸»è§‚è´¨é‡è¯„ä»·
- **ä½¿ç”¨ç»Ÿè®¡**: åŠŸèƒ½ä½¿ç”¨é¢‘ç‡
- **é—®é¢˜æŠ¥å‘Š**: Bugå’ŒåŠŸèƒ½è¯·æ±‚

#### è¿­ä»£æ”¹è¿›
- **ä¼˜å…ˆçº§æ’åº**: åŸºäºå½±å“å’Œéš¾åº¦
- **å¿«é€Ÿè¿­ä»£**: å°æ­¥å¿«è·‘å¼€å‘
- **ç‰ˆæœ¬æ§åˆ¶**: åŠŸèƒ½ç‰ˆæœ¬ç®¡ç†

## ğŸ”® æœªæ¥å‘å±•æ–¹å‘

### 1. æŠ€æœ¯æ‰©å±•

#### æœºå™¨å­¦ä¹ é›†æˆ
- **è‡ªåŠ¨ä¼˜åŒ–**: åŸºäºMLçš„å‚æ•°è°ƒä¼˜
- **æ¨¡å¼è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«è®¾è®¡æ¨¡å¼
- **ä¸ªæ€§åŒ–**: ç”¨æˆ·åå¥½å­¦ä¹ 

#### å®æ—¶åä½œ
- **å¤šäººç¼–è¾‘**: å®æ—¶åä½œç¼–è¾‘
- **ç‰ˆæœ¬æ§åˆ¶**: Gitå¼ç‰ˆæœ¬ç®¡ç†
- **äº‘ç«¯åŒæ­¥**: è·¨è®¾å¤‡æ•°æ®åŒæ­¥

### 2. åŠŸèƒ½æ‰©å±•

#### 3Då¯è§†åŒ–
- **ç«‹ä½“æ¸²æŸ“**: 3Dåœ°ç‰¢å¯è§†åŒ–
- **VRæ”¯æŒ**: è™šæ‹Ÿç°å®ä½“éªŒ
- **åŠ¨æ€è§†è§’**: å¯è°ƒèŠ‚è§‚å¯Ÿè§’åº¦

#### æ™ºèƒ½ç”Ÿæˆ
- **AIè®¾è®¡**: æ™ºèƒ½åœ°ç‰¢ç”Ÿæˆ
- **é£æ ¼è¿ç§»**: ä¸åŒé£æ ¼è½¬æ¢
- **ä¸ªæ€§åŒ–**: ç”¨æˆ·åå¥½ç”Ÿæˆ

### 3. ç”Ÿæ€ç³»ç»Ÿå»ºè®¾

#### æ’ä»¶å¸‚åœº
- **ç¬¬ä¸‰æ–¹é€‚é…å™¨**: ç¤¾åŒºè´¡çŒ®
- **ä¸»é¢˜åŒ…**: è§†è§‰ä¸»é¢˜æ‰©å±•
- **å·¥å…·é›†æˆ**: ç¬¬ä¸‰æ–¹å·¥å…·é›†æˆ

#### ç¤¾åŒºå»ºè®¾
- **ç”¨æˆ·è®ºå›**: ç»éªŒåˆ†äº«å¹³å°
- **æ•™ç¨‹ç³»ç»Ÿ**: å­¦ä¹ èµ„æºå»ºè®¾
- **è´¡çŒ®æŒ‡å—**: å¼€å‘è€…æ–‡æ¡£

## ğŸ“š ç†è®ºåŸºç¡€

### 1. æ¸¸æˆè®¾è®¡ç†è®º
- Schell, J. (2008). The art of game design
- Fullerton, T. (2014). Game design workshop
- Salen, K., & Zimmerman, E. (2004). Rules of play

### 2. è§†è§‰è®¾è®¡ç†è®º
- Arnheim, R. (1954). Art and visual perception
- Itten, J. (1970). The elements of color
- Norman, D. A. (2004). Emotional design

### 3. ç©ºé—´è®¤çŸ¥ç†è®º
- Lynch, K. (1960). The image of the city
- Kaplan, S., & Kaplan, R. (1982). Cognition and environment
- Golledge, R. G. (1999). Wayfinding behavior

### 4. æ ¼å¼å¡”å¿ƒç†å­¦
- Wertheimer, M. (1923). Laws of organization in perceptual forms
- Koffka, K. (1935). Principles of Gestalt psychology
- Wagemans, J., et al. (2012). A century of Gestalt psychology

### 5. ç½‘ç»œç§‘å­¦
- Newman, M. E. J. (2010). Networks: An introduction
- BarabÃ¡si, A. L. (2016). Network science
- Watts, D. J. (2004). Six degrees: The science of a connected age

## ğŸ“‹ æ€»ç»“

Dungeon Adapter é¡¹ç›®é€šè¿‡ç§‘å­¦çš„æ–¹æ³•è®ºä½“ç³»ï¼Œå°†åœ°ç‰¢è®¾è®¡ä»è‰ºæœ¯åˆ›ä½œè½¬åŒ–ä¸ºå¯é‡åŒ–ã€å¯è¯„ä¼°ã€å¯æ”¹è¿›çš„å·¥ç¨‹è¿‡ç¨‹ã€‚åŸºäºåšå®çš„ç†è®ºåŸºç¡€å’Œå…ˆè¿›çš„æŠ€æœ¯æ¶æ„ï¼Œé¡¹ç›®ä¸ºåœ°ç‰¢è®¾è®¡æä¾›äº†å…¨é¢çš„è§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨æ•´ä¸ªè¡Œä¸šçš„æ ‡å‡†åŒ–å’Œä¸“ä¸šåŒ–å‘å±•ã€‚

### æ ¸å¿ƒè´¡çŒ®
1. **ç§‘å­¦åŒ–**: åŸºäºå­¦æœ¯ç†è®ºçš„è´¨é‡è¯„ä¼°ä½“ç³»
2. **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„æ•°æ®æ ¼å¼å’Œè¯„ä¼°æ ‡å‡†
3. **å®ç”¨åŒ–**: å¯æ“ä½œçš„è®¾è®¡æŒ‡å¯¼åŸåˆ™
4. **å¯æ‰©å±•**: æ¨¡å—åŒ–æ¶æ„æ”¯æŒæŒç»­å‘å±•

### åº”ç”¨ä»·å€¼
1. **è®¾è®¡æŒ‡å¯¼**: ä¸ºåœ°ç‰¢è®¾è®¡è€…æä¾›ç§‘å­¦æŒ‡å¯¼
2. **è´¨é‡ä¿è¯**: å»ºç«‹å®¢è§‚çš„è´¨é‡è¯„ä¼°æ ‡å‡†
3. **å·¥å…·æ”¯æŒ**: æä¾›å®ç”¨çš„è®¾è®¡å·¥å…·
4. **ç ”ç©¶åŸºç¡€**: ä¸ºç›¸å…³ç ”ç©¶æä¾›æ•°æ®æ”¯æŒ 